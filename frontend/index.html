<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¡ï¸ æ•¸æ“šæ ¸å¿ƒï¼šLumiTrackç³»çµ±</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        
        /* --------------------------- å…¨åŸŸè®Šæ•¸ --------------------------- */
        :root{
            --bg-dark: #0f1115;
            --bg-secondary: #1e1e1e;
            --neon-blue: #a7d7ff;
            --neon-pink: #ffb3cf;
            --neon-green: #a8f0c6;
            --neon-yellow: #fff1a6;
            --text-light: #e6e6e6;
            --text-dark: #b8b8b8;
            --gray-default: #d8d8d8;
            --sidebar-width: 200px;
            --sidebar-collapsed-width: 72px;

            --border-color: #2a2a2a;                 /* é‚Šæ¡†é¡è‰² */

            /* åˆ†é¡é¡è‰²è®Šæ•¸ (å¯æ ¹æ“šæ‚¨çš„éœ€æ±‚èª¿æ•´) */
            --cat-1: #ff7f7f;
            --cat-2: #ffcc66;
            --cat-3: #a8f0c6;
            --cat-4: #a7d7ff;
            --cat-5: #ffb3cf;
            --cat-6: #cf9cff;
            --cat-7: #66ffcc;
            --cat-8: #ff9c66;
            --cat-9: #99ccff;
            --cat-10: #d4d4d4;
            --cat-11: #ffd1dc;
            --cat-12: #ffe066;
            --cat-13: #8affc1;
            --cat-14: #8ed1ff;
            --cat-15: #c9a7ff;
            --cat-16: #ffb380;
            --cat-17: #b3ffb3;
            --cat-18: #b3d9ff;
            --cat-19: #ffe6b3;
            --cat-20: #ffadad;
        }

        /* çµ±ä¸€çš„éœ“è™¹æ¨£å¼ */
        .neon-text {
            text-shadow: 0 0 5px var(--neon-blue), 0 0 10px var(--neon-blue);
            transition: text-shadow 0.3s;
        }
        .neon-pink-text {
            text-shadow: 0 0 5px var(--neon-pink), 0 0 10px var(--neon-pink);
            transition: text-shadow 0.3s;
        }
        .neon-shadow {
            box-shadow: 0 0 10px rgba(167, 215, 255, 0.3), 0 0 20px rgba(167, 215, 255, 0.1);
            transition: box-shadow 0.3s;
        }
        /* Active ç‹€æ…‹æŒ‰éˆ•çš„éœ“è™¹å…‰æšˆ */
        .active-neon-glow {
            box-shadow: 0 0 8px var(--neon-blue), 0 0 15px var(--neon-blue)50;
            border-color: var(--neon-blue) !important;
        }

        /* çµ±ä¸€ Font-Awesome åœ–æ¨™æ¨£å¼ */
        .fa, .fas, .far, .fab {
            margin-right: 5px;
        }

        /* --------------------------- åŸºç¤ç‰ˆé¢ --------------------------- */
        body{
            margin:0;
            padding:0;
            background: var(--bg-dark);
            color: var(--text-light);
            font-family: 'Noto Sans TC', 'Poppins', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            display:flex; /* å•Ÿç”¨ Flexbox */
            min-height: 100vh;
            overflow: hidden; /* é˜²æ­¢ä¸»é é¢å‡ºç¾æ»¾å‹•æ¢ */
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox (é›–ç„¶æ‚¨ä¸»è¦ä½¿ç”¨çš„æ˜¯ Webkit/MSï¼Œä½†çµ±ä¸€åŠ ä¸Š) */
        }

                /* --------------------------- éš±è—æ»¾å‹•æ¢ï¼šWebkit æ ¸å¿ƒç€è¦½å™¨ (Chrome, Safari) --------------------------- */
        /* é‡å°æ•´å€‹ body å…ƒç´  */
        body::-webkit-scrollbar {
            width: 0px;  /* éš±è—å‚ç›´æ»¾å‹•æ¢ */
            height: 0px; /* éš±è—æ°´å¹³æ»¾å‹•æ¢ */
        }

        body::-webkit-scrollbar,
        .content-container::-webkit-scrollbar,
        .category-list-container::-webkit-scrollbar {
            display: none;
            width: 0 !important;
            height: 0 !important;
        }

        /* 1. é‡å°æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…å« body å’Œæ‰€æœ‰ divï¼‰éš±è—æ»¾å‹•æ¢ï¼Œä½†ä¿ç•™æ»¾å‹•åŠŸèƒ½ */
        * {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;     /* Firefox */
        }

        *::-webkit-scrollbar {
            display: none;             /* Chrome, Safari, Opera */
            width: 0 !important;
            height: 0 !important;
        }

        /* 2. ç¢ºä¿ html å’Œ body ä¹Ÿå®Œå…¨éš±è— */
        html, body {
            overflow: -moz-scrollbars-none;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        body::-webkit-scrollbar {
            display: none;
        }

        /* é‡å°éœ€è¦æ»¾å‹•çš„ç‰¹å®šå®¹å™¨ (å¦‚ä¸»è¦çš„å…§å®¹å€å¡Š) */
        .content-container::-webkit-scrollbar,
        .category-list-container::-webkit-scrollbar {
            width: 0px;
            height: 0px;
        }
        
        /* --------------------------- å´é‚Šæ¬„ --------------------------- */
        .app-sidebar{
            width: var(--sidebar-width);
            min-width: var(--sidebar-width);
            background: rgba(10,12,18,0.7);
            backdrop-filter: blur(8px);
            padding: 16px 12px;
            display:flex;
            flex-direction: column;
            gap: 12px;
            border-right: 1px solid rgba(255,255,255,0.04);
            transition: width .28s ease;
            height: 100vh;
            position: sticky;
            top:0;
        }

        /* æ”¶åˆç‹€æ…‹ */
        .app-sidebar.collapsed{
            width: var(--sidebar-collapsed-width);
            min-width: var(--sidebar-collapsed-width);
        }

        /* æ”¶åˆæŒ‰éˆ• */
        .sidebar-toggle{
            background: transparent;
            border: none;
            color: var(--text-light);
            padding: 8px;
            cursor: pointer;
            align-self: flex-end;
        }

        /* LOGO */
        .sidebar-brand{
            display:flex;
            align-items:center;
            gap:10px;
            padding: 6px 8px;
        }

        .brand-mark{
            width:36px; height:36px;
            display:flex;
            align-items:center;
            justify-content:center;
            background: linear-gradient(90deg,var(--neon-blue), #7ee0ff20);
            border-radius:8px;
        }

        .brand-text{
            font-size: 1rem;
            color: var(--neon-blue);
            font-weight:700;
            text-shadow: 0 0 20px #8fd3ff;
        }

        /* é¸å–® */
        .sidebar-menu{
            list-style:none;
            padding:8px 4px;
            margin:0;
            display:flex;
            flex-direction:column;
            gap:6px;
        }

        .nav-item{
            display:flex;
            align-items:center;
            gap:12px;
            border-radius:10px;
            cursor:pointer;
            border:none;
            background:transparent;
            color:var(--text-light);

            padding: 10px 12px; /* çµ±ä¸€é–“è· */
            color: var(--text-dark);
            font-size: 1.05em; /* çµ±ä¸€å­—é«”å¤§å° */
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-item:hover{
            background: rgba(155,228,255,0.05);
            transform: translateX(4px);
            color: var(--text-light);
        }

        .nav-item.active{
            color: var(--neon-blue);
            background: rgba(155,228,255,0.15);
            box-shadow: 0 0 10px rgba(155,228,255,0.3);
            text-shadow: 0 0 5px var(--neon-blue);
        }

        /* çµ±ä¸€åœ–æ¨™å¤§å° */
        .nav-item i {
            font-size: 1.3em;
            width: 25px; /* ç¢ºä¿åœ–æ¨™å€åŸŸä¸€è‡´ */
        }

        .nav-icon{
            width:25px;
            text-align:center;
        }

        /* æ”¶åˆæ™‚éš±è—æ–‡å­— */
        .app-sidebar.collapsed .nav-label,
        .app-sidebar.collapsed .brand-text{
            display:none;
        }
        
        /* --------------------------- å…§å®¹å€å¡Š (ä½¿ç”¨ iframe) --------------------------- */
        /* â­ï¸ NEW: æ›¿æ›åŸæœ¬çš„ .main-contentï¼Œä½¿ç”¨ iframe è¼‰å…¥å…§å®¹ */
        #content-frame {
            flex-grow: 1; /* ä½”æ“šå‰©é¤˜ç©ºé–“ */
            border: none;
            width: 100%;
            height: 100vh; /* ç¢ºä¿ iframe ä½”æ»¿é«˜åº¦ */
            background-color: var(--bg-dark); 
            transition: all .3s ease-in-out; /* ä¿æŒèˆ‡ sidebar å¯¬åº¦åˆ‡æ›åŒæ­¥ */
        }

    </style>

</head>

<body>

    <nav class="app-sidebar">
        <button id="sidebarToggle" class="sidebar-toggle">
            <i class="fas fa-bars"></i>
        </button>

        <div class="sidebar-brand">
            <span class="brand-mark">âš¡</span>
            <span class="brand-text">LumiTrack</span>
        </div>

        <ul id="sidebarMenu" class="sidebar-menu">

            <li>
                <button class="nav-item" data-page="list" onclick="switchPage( this, 'transaction.html' )">
                    <span class="nav-icon"><i class="fas fa-list"></i></span>
                    <span class="nav-label">äº¤æ˜“è¨˜éŒ„</span>
                </button>
            </li>

            <li>
                <button class="nav-item" data-page="record" onclick="switchPage( this, 'recordpage.html' )">
                    <span class="nav-icon"><i class="fas fa-edit"></i></span>
                    <span class="nav-label">è¨˜å¸³é é¢</span>
                </button>
            </li>

            <li>
                <button class="nav-item" onclick="switchPage( this, 'report.html' )">
                    <span class="nav-icon"><i class="fas fa-chart-pie"></i></span>
                    <span class="nav-label">å ±å‘Šåˆ†æ</span>
                </button>
            </li>

            <li>
                <button class="nav-item" onclick="switchPage( this, 'budget.html' )">
                    <span class="nav-icon"><i class="fas fa-wallet"></i></span>
                    <span class="nav-label">ç®¡ç†é ç®—</span>
                </button>
            </li>

            <li>
                <button class="nav-item" onclick="switchPage( this, 'settings.html' )">
                    <span class="nav-icon"><i class="fas fa-cog"></i></span>
                    <span class="nav-label">ç³»çµ±è¨­å®š</span>
                </button>
            </li>

        </ul>

    </nav>

    <iframe id="content-frame" name="content-frame" src="transaction.html"></iframe>

</body>

<script>
/* ==============================
   å´é‚Šæ¬„ & é é¢åˆ‡æ›ï¼ˆåŸæœ¬çš„ ê·¸ëŒ€ë¡œï¼‰
================================ */
document.getElementById("sidebarToggle").addEventListener("click", () => {
    document.querySelector(".app-sidebar").classList.toggle("collapsed");
});

function switchPage(element, url) {
    document.getElementById('content-frame').src = url;
    document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));

    if (element) {
        element.classList.add("active");
    } else {
        let targetPageName;
        if (url.includes('recordpage')) targetPageName = 'record';
        else if (url.includes('transaction')) targetPageName = 'list';
        else if (url.includes('report')) targetPageName = 'report';
        else if (url.includes('budget')) targetPageName = 'budget';
        else if (url.includes('settings')) targetPageName = 'settings';

        const navItem = document.querySelector(`.nav-item[data-page="${targetPageName}"]`);
        if (navItem) navItem.classList.add('active');
    }
}

window.switchPage = switchPage;

/* ==============================
   ğŸŒ åŒ¯ç‡ç³»çµ±ï¼ˆä¹–ä¹–æ•´ç†ç‰ˆï¼‰
================================ */

const ONE_DAY = 24 * 60 * 60 * 1000;

function getCurrencySetting() {
    return JSON.parse(localStorage.getItem('app_currency')) || {
        base: 'TWD',
        symbol: 'NT$',
        rates: {
            TWD: 1,
            USD: 0.032,
            JPY: 4.6
        }
    };
}

async function fetchLiveExchangeRates(base = 'TWD') {
    try {
        const res = await fetch(
            `https://api.exchangerate.host/latest?base=${base}`
        );
        const data = await res.json();
        if (!data?.rates) throw new Error('No rates');

        const setting = {
            base,
            symbol: base === 'TWD' ? 'NT$' : base,
            rates: data.rates,
            updatedAt: new Date().toISOString()
        };

        localStorage.setItem('app_currency', JSON.stringify(setting));

        window.dispatchEvent(
            new StorageEvent('storage', { key: 'app_currency' })
        );

        return setting;
    } catch {
        return getCurrencySetting();
    }
}

/* ==============================
   åˆå§‹åŒ–ï¼ˆåªç•™ä¸€å€‹ DOMContentLoadedï¼‰
================================ */
document.addEventListener('DOMContentLoaded', () => {

    // å´é‚Šæ¬„åˆå§‹äº®ç‡ˆ
    const initialItem = document.querySelector('.nav-item[data-page="list"]');
    if (initialItem) initialItem.classList.add('active');

    // åŒ¯ç‡åˆå§‹åŒ–
    const setting = getCurrencySetting();
    if (!setting.updatedAt || Date.now() - new Date(setting.updatedAt) > ONE_DAY) {
        fetchLiveExchangeRates(setting.base || 'TWD');
    }
});
</script>


</html>