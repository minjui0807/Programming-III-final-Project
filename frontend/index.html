<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>⚡️ 數據核心：LumiTrack系統</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
    /* --------------------------- 全域變數 --------------------------- */
    :root {
        --bg-dark: #0f1115;
        --bg-secondary: #1e1e1e;
        --neon-blue: #a7d7ff;
        --neon-pink: #ffb3cf;
        --neon-green: #a8f0c6;
        --neon-yellow: #fff1a6;
        --text-light: #e6e6e6;
        --text-dark: #b8b8b8;
        --gray-default: #d8d8d8;
        --sidebar-width: 200px;
        --sidebar-collapsed-width: 72px;
        --border-color: #2a2a2a;

        /* 分類顏色 */
        --cat-1: #ff7f7f; --cat-2: #ffcc66; --cat-3: #a8f0c6; --cat-4: #a7d7ff;
        --cat-5: #ffb3cf; --cat-6: #cf9cff; --cat-7: #66ffcc; --cat-8: #ff9c66;
        --cat-9: #99ccff; --cat-10: #d4d4d4; --cat-11: #ffd1dc; --cat-12: #ffe066;
        --cat-13: #8affc1; --cat-14: #8ed1ff; --cat-15: #c9a7ff; --cat-16: #ffb380;
        --cat-17: #b3ffb3; --cat-18: #b3d9ff; --cat-19: #ffe6b3; --cat-20: #ffadad;
    }

    /* --------------------------- 霓虹光暈 --------------------------- */
    .neon-text { text-shadow:0 0 5px var(--neon-blue),0 0 10px var(--neon-blue); transition: text-shadow 0.3s; }
    .neon-pink-text { text-shadow:0 0 5px var(--neon-pink),0 0 10px var(--neon-pink); transition: text-shadow 0.3s; }
    .neon-shadow { box-shadow:0 0 10px rgba(167,215,255,0.3),0 0 20px rgba(167,215,255,0.1); transition: box-shadow 0.3s; }
    .active-neon-glow { box-shadow:0 0 8px var(--neon-blue),0 0 15px rgba(167,215,255,0.5); border-color: var(--neon-blue)!important; }

    /* --------------------------- 滾動條隱藏 --------------------------- */
    html, body, * {
        -ms-overflow-style:none;
        scrollbar-width:none;
    }
    *::-webkit-scrollbar { display:none; width:0; height:0; }

    /* --------------------------- 基礎版面 --------------------------- */
    body {
        margin:0;
        padding:0;
        background: var(--bg-dark);
        color: var(--text-light);
        font-family:'Noto Sans TC','Poppins','微軟正黑體',sans-serif;
        display:flex;
        min-height:100vh;
        overflow:hidden;
    }

    /* --------------------------- 側邊欄 --------------------------- */
    .app-sidebar {
        width: var(--sidebar-width);
        min-width: var(--sidebar-width);
        background: rgba(10,12,18,0.7);
        backdrop-filter: blur(8px);
        padding: 16px 12px;
        display:flex;
        flex-direction: column;
        gap: 12px;
        border-right: 1px solid rgba(255,255,255,0.04);
        transition: width 0.28s ease;
        height: 100vh;
        position: sticky;
        top:0;
    }
    .app-sidebar.collapsed { width: var(--sidebar-collapsed-width); min-width: var(--sidebar-collapsed-width); }

    .sidebar-toggle {
        background: transparent;
        border: none;
        color: var(--text-light);
        padding: 8px;
        cursor: pointer;
        align-self: flex-end;
    }

    /* LOGO */
    .sidebar-brand {
        display:flex;
        align-items:center;
        gap:10px;
        padding:6px 8px;
    }
    .brand-mark { width:36px; height:36px; display:flex; align-items:center; justify-content:center; background:linear-gradient(90deg,var(--neon-blue), #7ee0ff20); border-radius:8px; }
    .brand-text { font-size:1rem; color: var(--neon-blue); font-weight:700; text-shadow:0 0 20px #8fd3ff; }

    /* 選單 */
    .sidebar-menu { list-style:none; padding:8px 4px; margin:0; display:flex; flex-direction:column; gap:6px; }
    .nav-item {
        display:flex; align-items:center; gap:12px;
        border-radius:10px; cursor:pointer; border:none;
        background:transparent; color: var(--text-dark);
        padding:10px 12px; font-size:1.05em; font-weight:500;
        transition: all 0.3s ease;
    }
    .nav-item:hover { background: rgba(155,228,255,0.05); transform:translateX(4px); color: var(--text-light); }
    .nav-item.active { color: var(--neon-blue); background: rgba(155,228,255,0.15); box-shadow:0 0 10px rgba(155,228,255,0.3); text-shadow:0 0 5px var(--neon-blue); }
    .nav-item i { font-size:1.3em; width:25px; }
    .nav-icon { width:25px; text-align:center; }
    .app-sidebar.collapsed .nav-label, .app-sidebar.collapsed .brand-text { display:none; }

    /* --------------------------- tooltip --------------------------- */
    .nav-item { position: relative; }
    .nav-item .tooltip {
        position: absolute;
        left: 100%;
        top: 50%;
        transform: translateY(-50%);
        background: var(--bg-secondary);
        color: var(--text-light);
        padding: 4px 8px;
        border-radius: 4px;
        white-space: nowrap;
        font-size: 0.85em;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s;
        z-index: 100;
    }
    .app-sidebar.collapsed .nav-item:hover .tooltip { opacity: 1; }

    /* --------------------------- iframe 內容區 --------------------------- */
    #content-frame { flex-grow:1; border:none; width:100%; height:100vh; background-color: var(--bg-dark); transition: all 0.3s ease-in-out; }

</style>
</head>

<body>

    <nav class="app-sidebar">
        <button id="sidebarToggle" class="sidebar-toggle"><i class="fas fa-bars"></i></button>
        <div class="sidebar-brand">
            <span class="brand-mark">⚡</span>
            <span class="brand-text">LumiTrack</span>
        </div>
        <ul id="sidebarMenu" class="sidebar-menu">
            <li>
                <button class="nav-item" data-page="list" onclick="switchPage(this,'transaction.html')">
                    <span class="nav-icon"><i class="fas fa-list"></i></span>
                    <span class="nav-label">交易記錄</span>
                    <span class="tooltip">交易記錄</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-page="record" onclick="switchPage(this,'recordpage.html')">
                    <span class="nav-icon"><i class="fas fa-edit"></i></span>
                    <span class="nav-label">記帳頁面</span>
                    <span class="tooltip">記帳頁面</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-page="report" onclick="switchPage(this,'report.html')">
                    <span class="nav-icon"><i class="fas fa-chart-pie"></i></span>
                    <span class="nav-label">報告分析</span>
                    <span class="tooltip">報告分析</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-page="budget" onclick="switchPage(this,'budget.html')">
                    <span class="nav-icon"><i class="fas fa-wallet"></i></span>
                    <span class="nav-label">管理預算</span>
                    <span class="tooltip">管理預算</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-page="settings" onclick="switchPage(this,'settings.html')">
                    <span class="nav-icon"><i class="fas fa-cog"></i></span>
                    <span class="nav-label">系統設定</span>
                    <span class="tooltip">系統設定</span>
                </button>
            </li>
        </ul>
    </nav>

    <iframe id="content-frame" name="content-frame" src="transaction.html"></iframe>

    <script>
        // --------------------------- 側邊欄收合 ---------------------------
        document.getElementById("sidebarToggle").addEventListener("click", () => {
            document.querySelector(".app-sidebar").classList.toggle("collapsed");
        });

        // --------------------------- 頁面切換 ---------------------------
        function switchPage(element, url) {
            document.getElementById('content-frame').src = url;
            document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));
            if (element) element.classList.add("active");
            else {
                const pageMap = { transaction:'list', recordpage:'record', report:'report', budget:'budget', settings:'settings' };
                const pageKey = Object.keys(pageMap).find(key => url.includes(key));
                const navItem = document.querySelector(`.nav-item[data-page="${pageMap[pageKey]}"]`);
                if (navItem) navItem.classList.add('active');
            }
        }
        window.switchPage = switchPage;

        // --------------------------- 固定匯率 ---------------------------
        const CURRENCY_KEY='app_currency';
        const SYMBOL_MAP={ TWD:'NT$', USD:'$', JPY:'¥', EUR:'€', HKD:'HK$', CNY:'¥', GBP:'£', AUD:'A$', KRW:'₩', SGD:'S$' };

        // 直接固定匯率
        const FIXED_CURRENCY = {
            base: 'TWD',
            rates: { TWD:1, USD:0.032, JPY:4.6, EUR:0.029 },
            updatedAt: new Date().toISOString()
        };
        localStorage.setItem(CURRENCY_KEY, JSON.stringify(FIXED_CURRENCY));

        window.getCurrencySetting = function() {
            return JSON.parse(localStorage.getItem(CURRENCY_KEY)) || { base: 'TWD', rates: { TWD:1 } };
        };

        window.convertAmount = function(amountInTWD, toTarget = true) {
            const { base, rates } = getCurrencySetting();
            const rate = rates[base] || 1;
            return toTarget ? amountInTWD * rate : amountInTWD / rate;
        };

        window.getCurrencySymbol = function() {
            const { base } = getCurrencySetting();
            return SYMBOL_MAP[base] || '$';
        };

        // --------------------------- 初始化 ---------------------------
        document.addEventListener('DOMContentLoaded', () => {
            const initialItem = document.querySelector('.nav-item[data-page="list"]');
            if (initialItem) initialItem.classList.add('active');
        });
    </script>

</body>
</html>
